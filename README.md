# DeepSeek OCR Batch Runner

Run [DeepSeek-OCR](https://huggingface.co/deepseek-ai/DeepSeek-OCR) locally on Windows + CUDA to convert image folders into Markdown and a summary CSV.

## Setup

1. Create/activate a Python environment (Python 3.12+).
2. Install dependencies with your preferred tool, e.g. `uv sync` or `pip install -r requirements.txt` (generated by `uv pip compile`). Make sure `flash-attn` is available if you want to use Flash Attention 2.
3. Download the DeepSeek-OCR weights automatically from Hugging Face (default) or place them in a local directory for offline use.

> NOTE: The reference `infer` implementation relies on an NVIDIA GPU and bfloat16/float16 precision.

## Usage

```powershell
python main.py \
  --image-dir C:\path\to\images \
  --output-dir C:\path\to\results
```

### Offline / Local Weights

```powershell
python main.py --image-dir .\samples --output-dir .\outputs --model-path D:\models\DeepSeek-OCR --local-files-only
```

### Options

- `--prompt`: customise the instruction (defaults to Markdown conversion).
- `--base-size`, `--image-size`, `--no-crop`: mirror the DeepSeek-OCR `infer` parameters.
- `--dtype`: choose `bfloat16`, `float16`, or `float32`.
- `--attn-impl`: set to `''` if Flash Attention 2 is unavailable.

Results:

- A Markdown file per input image written to the output directory.
- `results.csv` summarising image names, Markdown filenames, inference status, and recognised text.
